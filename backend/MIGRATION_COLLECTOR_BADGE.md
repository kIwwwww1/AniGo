# Миграция: Добавление бейджа "Коллекционер #1"

## Описание
Добавляет функциональность бейджа "Коллекционер #1" для топ-1 пользователя в разделе "Топ коллекционеров".

## Изменения

### База данных
- Добавлено поле `collector_badge_expires_at` в таблицу `user_profile_settings`
- Поле хранит дату истечения бейджа (NULL если бейдж не активен)

### Backend
- Обновлена модель `UserProfileSettingsModel` для поддержки бейджа
- Создана функция `update_collector_badge()` для автоматического обновления бейджа
- Функция вызывается при получении топ пользователей (только при offset=0)
- Обновлены все API endpoints для возврата информации о бейдже

### Frontend
- Добавлен бейдж "Коллекционер #1" в профиль пользователя
- Бейдж отображается только если `has_collector_badge === true`
- Стили бейджа: золотой градиент с анимацией

## Логика работы

1. При загрузке топ пользователей (offset=0) автоматически вызывается `update_collector_badge()`
2. Функция определяет топ-1 пользователя по количеству избранного
3. Если топ-1 изменился или бейдж истек:
   - Бейдж забирается у предыдущего владельца (если был)
   - Бейдж выдается новому топ-1 пользователю на 1 неделю
4. Бейдж автоматически истекает через 1 неделю
5. При следующем обновлении топ пользователей бейдж переходит к новому топ-1

## Запуск миграции

```bash
# Выполнить SQL миграцию
psql -U your_user -d your_database -f backend/migrations/add_collector_badge.sql
```

## Проверка

После миграции проверьте:
1. Поле `collector_badge_expires_at` добавлено в таблицу
2. При загрузке топ пользователей бейдж автоматически выдается топ-1
3. Бейдж отображается в профиле пользователя
4. Бейдж автоматически истекает через 1 неделю
